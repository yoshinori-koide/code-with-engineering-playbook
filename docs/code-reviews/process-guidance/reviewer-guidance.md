# レビューアガイダンス

※ オリジナル: https://microsoft.github.io/code-with-engineering-playbook/code-reviews/process-guidance/reviewer-guidance/

レビューの一部はリンターなどを介して自動化できるため、人間のレビュー担当者はアーキテクチャと機能の正確さに集中できます。人間のレビュー担当者は以下に焦点を当てる必要があります。

- コードで具体化されたビジネスロジックの正確さ。
- 新規または変更されたテストの正確さ。
- 全体的な設計決定の「読みやすさ」と保守性は、コードに反映されています。
- チームがプログラミング言語ごとに維持する一般的なエラーのチェックリスト。

コードレビューでは、以下のガイダンスとチェックリストを使用して、積極的かつ効果的なコードレビューを確保する必要があります。

## 一般的なガイダンス

### レビューしているコードを理解する

- 変更されたすべての行を読み取ります。
- 利害関係者のレビューがある場合は、コードの理解に役立つ場合を除いて、PRを実行する必要はありません。
- AzDOはファイルを注文しますが、理解しやすいように、論理的な順序でコードを読む必要があります。
- コンテキストがないためにファイルの変更を完全に理解していない場合は、クリックしてファイル全体を表示し、周囲のコードを読み通すか、変更をチェックアウトしてIDEで表示してください。
- 著者に明確にするように依頼します。

### 時間をかけてスコープに集中してください

コードを急いでレビューするべきではありませんが、一度に時間がかかりすぎることもありません。レビューするプルリクエスト（PR）が多数ある場合、またはコードの複雑さが要求される場合は、レビューの合間に休憩を取って回復し、最も経験のあるものに焦点を当てることをお勧めします。

コードレビューの目標は、対応するタスクの目標が達成されたことを確認することであることを常に忘れないでください。PRの範囲外の関連する隣接するコードについて懸念がある場合は、それらを個別のタスク（バグ、技術的負債など）として対処してください。範囲外の問題のために現在のPRをブロックしないでください。

## ポジティブなコードレビュー文化を育む

コードレビューは製品の品​​質に重要な役割を果たしており、長い議論やさらに悪いことにエゴの戦いの場を表すものであってはなりません。重要なのは、バグを見つけたということであり、誰がそれを作ったのか、誰がそれを見つけたのか、誰がそれを修正したのかではありません。重要なのは、可能な限り最高の製品を手に入れることだけです。

## 思いやりがある

- ポジティブになりましょう – 励まし、グッドプラクティスへの感謝
- 「磨きのポイント」の前に「Nit：」を付けます。
- 「あなた」のように指を指す言葉は避け、「私たち」または「この行」を使用してください。コードレビューは個人的なものではなく、言語の問題です。
- 発言するよりも質問をすることをお勧めします。著者が何かをするのには十分な理由があるかもしれません。
- 直接コメントする場合は、コードを変更する必要がある理由を、できれば例を挙げて説明してください。
- 変更について言えば、提案機能（[GitHub](https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/commenting-on-a-pull-request#adding-line-comments-to-a-pull-request)およびAzure DevOpsで利用可能）を使用するか、作成者ブランチにPRを作成することで、PRへの変更を提案できます。
- いくつかの前後のコメントで意見の不一致が解決されない場合は、お互いに（直接または電話で）簡単に話し合うか、グループディスカッションを作成してください。これにより、今後のPRのさまざまな改善につながる可能性があります。同意した内容とその理由でPRを更新することを忘れないでください。

## 最初のデザインパス

### プルリクエストの概要

- PRの説明は意味がありますか？
- すべての変更はこのPRに論理的に適合していますか、それとも無関係な変更がありますか？
- 必要に応じて、加えられた変更はREADMEまたは他のドキュメントの更新に反映されますか？特に、変更がユーザーのコード作成方法に影響を与える場合。

### ユーザー向けの変更

- コードにユーザー向けの変更が含まれている場合、機能を説明するGIF /写真はありますか？そうでない場合は、PRを検証して、変更が期待どおりに行われることを確認することが重要になる場合があります。
- 期しない動作が発生することなく、UIの変更が適切に表示されることを確認します。

### デザイン

- PR内のさまざまなコードの相互作用は意味がありますか？
- コードはアーキテクチャとコーディングパターンを認識して組み込んでいますか？

## コード品質パス

### 複雑

- 機能が複雑すぎませんか？
- 単一責任の原則が守られていますか？関数またはクラスは1つの「こと」を実行する必要があります。
- 関数を複数の関数に分割する必要がありますか？
- メソッドに3つを超える引数がある場合、それは潜在的に過度に複雑です。
- コードは必要のない機能を追加しますか？
- コードリーダーはコードを簡単に理解できますか？

### 命名/読みやすさ

- 開発者は関数や変数などに適切な名前を付けましたか？

### エラー処理

- エラーは必要に応じて適切かつ明示的に処理されますか？

### 機能性

- このPRには、競合状態を引き起こす可能性のある並列プログラミングがありますか？このロジックを注意深く読んでください。
- コードを最適化できますか？例：データベースへの呼び出しが必要以上に多いですか？
- 機能は全体像にどのように適合しますか？システム全体に悪影響を与える可能性はありますか？
- セキュリティ上の欠陥はありますか？
- 変数名は顧客固有の情報を明らかにしますか？
- PIIとEUIIは正しく扱われていますか？PII情報をログに記録していますか？

### スタイル

- 無関係なコメントはありますか？コードがそれ自体を説明するのに十分明確でない場合は、コードをより単純にする必要があります。いくつかのコードが存在する理由を説明するコメントがあるかもしれません。
- コードは、私たちが合意したスタイルガイド/規則に準拠していますか？黒やきれいな自動スタイリングを使用しています。

### テスト

- テストは常にコード自体と同じPRでコミットする必要があります（「次にテストを追加します」は受け入れられません）。
- テストが賢明であり、有効な仮定が行われていることを確認してください。
- エッジケースも処理されることを確認してください。
- テストは、変更を理解するための優れた情報源になります。変更をよりよく理解するために、最初にテストを確認することをお勧めします。
